<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学習記録を画像で共有 | テス勉お助け！</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- ヘッダー -->
    {% include '_header.html' %}

    <div class="max-w-4xl mx-auto p-6">
        <!-- ページヘッダー -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-green-600 mb-2 flex items-center justify-center">
                <i class="ph-bold ph-image text-3xl mr-3"></i>
                学習記録を画像で共有
            </h1>
            <p class="text-gray-600">{{ user.username }}さんの学習記録</p>
        </div>

        <!-- 学習記録のプレビュー -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="ph-bold ph-eye text-xl mr-2 text-green-600"></i>
                学習記録プレビュー
            </h3>
            
            <div class="bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl p-8 text-white">
                <div class="flex justify-between items-start mb-6">
                    <div class="text-2xl font-bold">StudyApp</div>
                    <div class="text-right">
                        <div class="font-semibold">{{ user.username }}</div>
                        <div class="text-sm opacity-80">{{ current_date }}</div>
                    </div>
                </div>
                
                <!-- 学習記録カード -->
                <div class="bg-white bg-opacity-20 rounded-lg p-6 mb-6">
                    <h3 class="text-2xl font-bold mb-4 text-white">{{ record.subject }}</h3>
                    
                    <div class="space-y-2 text-white">
                        <div class="flex justify-between">
                            <span>学習時間:</span>
                            <span class="font-semibold">{{ record.learning_time }} 分</span>
                        </div>
                        <div class="flex justify-between">
                            <span>学習日:</span>
                            <span class="font-semibold">{{ record.study_date }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>難易度:</span>
                            <span class="font-semibold">{{ record.difficulty }}/5</span>
                        </div>
                    </div>
                    
                    {% if record.content %}
                    <div class="mt-4 pt-4 border-t border-white border-opacity-30">
                        <h4 class="font-semibold mb-2">学習内容:</h4>
                        <p class="text-sm opacity-90">{{ record.content }}</p>
                    </div>
                    {% endif %}
                </div>
                
                <div class="text-center mt-6 text-sm opacity-80">
                    #StudyApp #学習記録
                </div>
            </div>
        </div>

        <!-- アクションボタン -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="ph-bold ph-download-simple text-xl mr-2 text-green-600"></i>
                画像を保存
            </h3>
            
            <div class="text-center space-y-4">
                <p class="text-gray-600">この学習記録を画像として保存して共有しましょう</p>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="captureScreenshot()" 
                            class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center justify-center">
                        <i class="ph-bold ph-camera mr-2"></i>スクリーンショットを撮る
                    </button>
                    <!-- 修正箇所: records → share_single に変更 -->
                    <a href="{{ url_for('share_single', record_id=record.id) }}" 
                       class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition duration-200 flex items-center justify-center">
                        <i class="ph-bold ph-arrow-left mr-2"></i>戻る
                    </a>
                </div>
                
                <p class="text-sm text-gray-500">
                    ※ スクリーンショット機能を使用して画像を保存してください<br>
                    ※ 保存した画像はSNSなどで共有できます
                </p>
            </div>
        </div>

        <!-- 使い方ガイド -->
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-6 mt-6">
            <h4 class="font-bold text-blue-800 mb-3 flex items-center">
                <i class="ph-bold ph-info text-lg mr-2"></i>
                使い方ガイド
            </h4>
            <ul class="text-sm text-blue-700 space-y-2">
                <li>1. 「スクリーンショットを撮る」ボタンをクリック</li>
                <li>2. 学習記録のプレビュー部分を選択してスクリーンショットを撮影</li>
                <li>3. 保存した画像をSNSやメッセージアプリで共有</li>
            </ul>
        </div>
    </div>

    <script>
        function captureScreenshot() {
            // シンプルなスクリーンショットガイドを表示
            alert('スクリーンショットの方法:\n\nWindows: Windows + Shift + S\nMac: Shift + Command + 4\n\n学習記録のプレビュー部分を選択してスクリーンショットを撮ってください。');
            
            // プレビュー部分をハイライト
            const preview = document.querySelector('.bg-gradient-to-br');
            preview.style.boxShadow = '0 0 0 4px #4CAF50';
            preview.style.transition = 'box-shadow 0.3s ease';
            
            setTimeout(() => {
                preview.style.boxShadow = 'none';
            }, 2000);
        }
    </script>
</body>
</html>